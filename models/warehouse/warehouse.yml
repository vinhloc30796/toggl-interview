
version: 2

models:
  - name: dim_users
    description: "Users' characteristics & attribution"
    columns:
      - name: user_id
        description: "The user's ID - also the table's PK"
        tests:
            - unique
            - not_null
      - name: created_at
        description: "The user's creation time"
      - name: activated_at
        description: "The user's activation time"
      - name: deleted_at
        description: "The user's deletion time"
      - name: fta_date
        description: "The user's first touch attributed date"
      - name: fta_campaign
        description: "The user's first touch attributed UTM campaign"
      - name: fta_source
        description: "The user's first touch attributed UTM source"
      - name: fta_medium
        description: "The user's first touch attributed UTM medium"
  
  - name: fct_charges
    description: "Charges for each month"
    tests:
    # Ensuring that we don't have duplicate rows
    # across the below column
    - dbt_utils.unique_combination_of_columns:
        combination_of_columns:
          - workspace_id
          - charge_month
    columns:
      - name: charge_month
      - name: amount_id
      - name: user_count

  - name: dim_workspaces
    description: "Workspaces are collections of 1 or more Toggl Track users. Every workspace has exactly 1 user that is the workspace owner"
    columns:
      - name: workspace_id
        description: "The workspace's ID - also the table's PK"
        tests:
          - unique
          - not_null
      - name: most_recent_charge_month
      - name: most_recent_user_count
      - name: most_recent_plan_period
      - name: most_recent_plan_name
      - name: total_charge_amount
        tests:
          - not_null